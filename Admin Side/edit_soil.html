<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Soil Compatibility</title>
    <!-- CSS files -->
    <link href="dist/css/tabler.min.css" rel="stylesheet"/>
    <link href="dist/css/tabler-flags.min.css" rel="stylesheet"/>
    <link href="dist/css/tabler-payments.min.css" rel="stylesheet"/>
    <link href="dist/css/tabler-vendors.min.css" rel="stylesheet"/>
    <link href="dist/css/demo.min.css" rel="stylesheet"/>
  </head>
  <body class="antialiased">
    <div class="wrapper">
      <div class="sticky-top">
        <header class="navbar navbar-expand-md navbar-light d-print-none ">
          <div class="container-xl">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
              <span class="navbar-toggler-icon"></span>
            </button>
            <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
              <a href="main.html">
                <img src="./static/logos.png" width="110" height="32" alt="Tabler" class="navbar-brand-image">
              </a>
            </h1>
            <div class="navbar-nav flex-row order-md-last">
              <div class="nav-item dropdown">
                <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                  <span class="avatar avatar-sm" style="background-image: url(./static/avatars/profiles.jpg)"></span>
                  <div class="d-none d-xl-block ps-2">
                  <div id="user_login" ></div>
                  <div class="mt-1 small text-muted">Admin</div>
                </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                  <a id="logout" href="#" class="dropdown-item">Logout</a>
                </div>
              </div>
            </div>
          </div>
        </header>
        <div class="navbar-expand-md ">
          <div class="collapse navbar-collapse" id="navbar-menu">
            <div class="navbar navbar-expand-md navbar-light  d-print-none ">
              <div class="container-xl">
                <ul class="navbar-nav">
                  <li class="nav-item ">
                    <a class="nav-link" href="main.html" >
                      <span class="nav-link-icon d-md-none d-lg-inline-block">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="5 12 3 12 12 3 21 12 19 12" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>
                      </span>
                      <span class="nav-link-title">
                        Home
                      </span>
                    </a>
                  </li>
                 
				   <li class="nav-item">
                    <a class="nav-link" href="manage_users.html" >
                      <span class="nav-link-icon d-md-none d-lg-inline-block">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><<polyline points="12 3 20 7.5 20 16.5 12 21 4 16.5 4 7.5 12 3" /><line x1="12" y1="12" x2="20" y2="7.5" /><line x1="12" y1="12" x2="12" y2="21" /><line x1="12" y1="12" x2="4" y2="7.5" /><line x1="16" y1="5.25" x2="8" y2="9.75" /></svg>
                      </span>
                      <span class="nav-link-title">
                        Manage Users
                      </span>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="manage_soil.html" >
                      <span class="nav-link-icon d-md-none d-lg-inline-block">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="9 11 12 14 20 6" /><path d="M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9" /></svg>
                      </span>
                      <span class="nav-link-title">
                        Manage Soil
                      </span>
                    </a>
                  </li>
				  <li class="nav-item">
                    <a class="nav-link" href="manage_plants.html" >
                      <span class="nav-link-icon d-md-none d-lg-inline-block">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="6" height="5" rx="2" /><rect x="4" y="13" width="6" height="7" rx="2" /><rect x="14" y="4" width="6" height="7" rx="2" /><rect x="14" y="15" width="6" height="5" rx="2" /></svg>
                      </span>
                      <span class="nav-link-title">
                        Manage Plants
                      </span>
                    </a>
                  </li>
                  
                  <li class="nav-item">
                    <a class="nav-link" href="manage_fertilizer.html" >
                      <span class="nav-link-icon d-md-none d-lg-inline-block">
						<svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="7" r="3" /><circle cx="17" cy="16" r="3" /><circle cx="7" cy="16" r="3" /></svg></span>
                      <span class="nav-link-title">
                        Manage Fertilizer
                      </span>
                    </a>
                  </li>
				  
                </ul>
                <div class="my-2 my-md-0 flex-grow-1 flex-md-grow-0 order-first order-md-last">
                <form action="." method="get">
                  <div class="input-icon">
                    <span class="input-icon-addon">
                      <!-- Download SVG icon from http://tabler-icons.io/i/search -->
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7" /><line x1="21" y1="21" x2="15" y2="15" /></svg>
                    </span>
                    <input type="text" id="myInput" class="form-control" placeholder="Searchâ€¦" aria-label="Search in website">
                  </div>
                </form>
              </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="page-wrapper">
        <div class="container-xl">
          <!-- Page title -->
          <div class="page-header d-print-none">
            
		  <br>
			<div class="row align-items-center">
              <div class="col">
                <!-- Page pre-title -->
                <div class="page-pretitle">
                  Soil Informations
                </div>
                
              </div>
            </div>
        </div>
        <div class="page-body">
          <div class="container-xl">
			<div class="col d-flex justify-content-center">
              <div class="card" style="width: 30rem;">
                
                <div class="card-body">
					
                  <form id="entry-form" method="POST" action="api/update_soil.php" class="needs-validation" novalidate>
						<input type="hidden" class="form-control" name="soil_id" id="soil_id"  required> 

					<div class="form-group mb-3" >
					    <label class="form-label">Soil Quality</label>
                      <div >
                        <select class="form-select" placeholder="Select Soil Quality" name="soil_quality" id="soil_quality" required="">
                          <option value="" >Soil Quality</option>
						  <option value="Extremely Strong Acid" >Extremely Strong Acid</option>
                          <option value="Strong Acid">Strong Acid</option>
                          <option value="Acid">Acid</option>
                          <option value="Neutral">Neutral</option>
                          <option value="Alkalinity">Alkalinity</option>
                          <option value="Strong Alkaline">Strong Alkaline</option>
						  <option value="Extremely Strong Alkaline">Extremely Strong Alkaline</option>
                        </select>
                      </div>
                    </div>
					<div class="form-group mb-3 ">
                      <label class="form-label">PH Level</label>
                      <div>
                        <input type="text" class="form-control" name="ph_level" id="ph_level" placeholder="PH Level" required> 
                      </div>
                    </div>
					<div class="form-group mb-3 ">
                      <label class="form-label">Moisture</label>
                      <div>
                        <input type="text" class="form-control" name="moisture" id="moisture" placeholder="Moisture" required> 
                      </div>
                    </div>
					<div class="form-group mb-3" >
					    <label class="form-label">Moisture Condition</label>
                      <div >
                        <select class="form-select" placeholder="Select Moisture Condition" name="moisture_condition" id="moisture_condition" required="">
                          <option value="" >Moisture Condition</option>
						  <option value="Very Wet">Very Wet</option>
                          <option value="Wet">Wet</option>
                          <option value="Moderate">Moderate</option>
                          <option value="Dry">Dry</option>
                          <option value="Very Dry">Very Dry</option>
                        </select>
                      </div>
                    </div>
					<br>
				    

                    <div class="form-footer text-end">
					  <a href="manage_soil.html" class="btn btn-secondary btn-pill">Cancel</a>
                      <button type="submit" id="btnFetch" class="btn btn-teal btn-pill">Update</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
			
				<div id="confirmation_failed" class="alert alert-danger invisible">
				<span class="fas fa-circle-notch fa-spin"></span> Entry failed!
				</div>
		</div>
    </div>
    <div class="modal modal-blur fade" id="modal-success" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          <div class="modal-status bg-success"></div>
          <div class="modal-body text-center py-4">
            
            <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-green icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9" /><path d="M9 12l2 2l4 -4" /></svg>
            <h3>Soil successfully update</h3>
    
          </div>
          <div class="modal-footer">
            <div class="w-100">
              <div class="row">
                <div class="col"><a href="manage_soil.html" class="btn btn-success w-100">
                    Ok
                  </a></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	</div>
	</div>
	</div>
    <!-- Libs JS -->
    <script src="dist/libs/apexcharts/dist/apexcharts.min.js"></script>
	<script src="dist/libs/choices.js/public/assets/scripts/choices.js"></script>
    <!-- Tabler Core -->
    <script src="dist/js/tabler.min.js"></script>
    <script src="dist/js/jquery.min.js"></script>
	<style>
	.show {
		transition: opacity 1ms; // You can play with the 1
	}
	</style>
    <script>
		
		(function() {
		  var inputNum = document.getElementById("ph_level");
		  inputNum.addEventListener("keyup", function(){
			 var num = inputNum.value;
				if(num <= 4.5 && num >= 1)
			   {
					$("#soil_quality").val("Extremely Strong Acid");
			   }
			   else if(num > 4.5 && num <= 5.5)
			   {
					$("#soil_quality").val("Strong Acid");
			   }
			   else if(num > 5.5 && num <= 6.5)
			   {
					$("#soil_quality").val("Acid");
			   }
			   else if(num > 6.5 && num <= 7.5)
			   {
					$("#soil_quality").val("Neutral");
			   }
			   else if(num > 7.5 && num <= 8.5)
			   {
					$("#soil_quality").val("Alkalinity");
			   }
			   else if(num > 8.5 && num <= 9.5)
			   {
					$("#soil_quality").val("Strong Alkaline");
			   }
			   else if(num >= 9.5 && num <= 10)
			   {
					$("#soil_quality").val("Extremely Strong Alkaline");
			   }
			   else
			   {
					$("#soil_quality").val("");
			   }
		  });  
		})();
	</script>
	<script>
		
		(function() {
		  var input_moisture = document.getElementById("moisture");
		  input_moisture.addEventListener("keyup", function(){
			 var moisture_level = input_moisture.value;
				if(moisture_level <= 1.6 && moisture_level >= 1)
			   {
					$("#moisture_condition").val("Very Dry");
			   }
			   else if(moisture_level > 1.6 && moisture_level <= 3.2)
			   {
					$("#moisture_condition").val("Dry");
			   }
			   else if(moisture_level > 3.2 && moisture_level <= 4.8)
			   {
					$("#moisture_condition").val("Moderate");
			   }
			   else if(moisture_level > 4.8 && moisture_level <= 6.4)
			   {
					$("#moisture_condition").val("Wet");
			   }
			   else if(moisture_level > 6.4 && moisture_level <= 8)
			   {
					$("#moisture_condition").val("Very Wet");
			   }
			   else
			   {
					$("#moisture_condition").val("");
			   }
		  });  
		})();
	</script>
	<script>
		$("document").ready(function(){
            var url = document.URL;
            var id = url.substring(url.lastIndexOf('=') + 1);
           
            $.get("api/get-soil-data.php?id=" + id, function(data){
                      // Display the returned data in browser
        
                var get_soil = data.split("/");
				
				$("#soil_id").val(get_soil[0]);
                $("#soil_quality").val(get_soil[1]);
                $("#ph_level").val(get_soil[2]);
				$("#moisture").val(get_soil[3]);
				$("#moisture_condition").val(get_soil[4]);
				
				
				
            });
				
		
		
	  });
	</script>
	>

	<script>
		(function() {	  
		  'use strict';
		  window.addEventListener('load', function() {		
			var forms = document.getElementsByClassName('needs-validation');	
			var validation = Array.prototype.filter.call(forms, function(form) {
			   form.addEventListener('submit', function(event) {
				if (form.checkValidity() === false) {
				event.preventDefault();
				event.stopPropagation();
				}
				else {
						$("#btnFetch").prop("disabled", true);
						// add spinner to button
						$("#btnFetch").html(
						"<span class='spinner-border spinner-border-sm' role='status' aria-hidden='true'></span>  &nbspLoading..."
						);
				event.preventDefault();

				var url = "api/update_soil.php";
					$.post(url, $("#entry-form").serialize(), function(data) {
					if(data == 1){
						
						
						$("#modal-success").modal('toggle');
				  	}
					else {
						alert("Entry failed!");
						$("#confirmation_failed").removeClass("invisible");
						$("#btnFetch").prop("disabled", false);
						$("#btnFetch").html(
						"<span  role='status' aria-hidden='true'></span> Submit"
						);
					}
				});
			}
				form.classList.add('was-validated');
				}, false);
			});
			}, false);
			})();
			
			
	</script>
	<script>
	function getCookie(cName) {
	    const name = cName + "=";
	    const cDecoded = decodeURIComponent(document.cookie); //to be careful
	    const cArr = cDecoded .split('; ');
	    let res;
	    cArr.forEach(val => {
		  if (val.indexOf(name) === 0) res = val.substring(name.length);
	    })
	    return res;
	  }
			
	  function eraseCookie(name) {   
		document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
	  }
	  
	  var user_name = getCookie('user_name');
	  var pwd = getCookie('pwd');
	  
	  //alert(usr + " " + pwd + " " + uty);
	  
	  if(user_name == undefined){
	      window.location.replace('index.html');
	  }
	  
	  $(document).ready(function(){
		  $.ajax({    //create an ajax request to display.php
				type: "GET",
				url: "api/get-current-login-data.php?id="+ user_name,             
				dataType: "html",   //expect html to be returned                
				success: function(response){                    
					$("#user_login").html(response); 
					//alert(response);
				}

			});	
		});
	</script>
	<script>
		$(document).ready(function(){
          $("#logout").click(function(){
            eraseCookie("user_name");
            eraseCookie("pwd");
            alert("Thank you for using the app.");
            window.location.replace('index.html');
          });
        });
	</script>
  </body>
</html>